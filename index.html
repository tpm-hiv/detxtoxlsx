<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>From DETX to XLSX</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Instrument+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.min.js"></script>
    <style>
        :root {
            --bg-deep: #0a0a0f;
            --bg-card: #12121a;
            --bg-elevated: #1a1a26;
            --accent-primary: #6366f1;
            --accent-glow: #818cf8;
            --accent-subtle: #4f46e5;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(99, 102, 241, 0.15);
            --border-active: rgba(99, 102, 241, 0.4);
            --success: #10b981;
            --success-glow: #34d399;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Instrument Sans', sans-serif;
            background: var(--bg-deep);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* Ambient background effect */
        .ambient-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .ambient-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            animation: float 20s ease-in-out infinite;
        }

        .orb-1 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, var(--accent-primary) 0%, transparent 70%);
            top: -200px;
            right: -100px;
            animation: float1 12s ease-in-out infinite, pulse1 8s ease-in-out infinite;
        }

        .orb-2 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, #8b5cf6 0%, transparent 70%);
            bottom: -100px;
            left: -100px;
            animation: float2 15s ease-in-out infinite, pulse2 6s ease-in-out infinite;
        }

        .orb-3 {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, #06b6d4 0%, transparent 70%);
            top: 40%;
            left: 30%;
            animation: float3 18s ease-in-out infinite, pulse3 10s ease-in-out infinite;
            opacity: 0.2;
        }

        @keyframes float1 {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            20% { transform: translate(150px, 80px) rotate(5deg); }
            40% { transform: translate(-80px, 150px) rotate(-3deg); }
            60% { transform: translate(100px, -60px) rotate(8deg); }
            80% { transform: translate(-120px, 40px) rotate(-5deg); }
        }

        @keyframes float2 {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(-120px, -100px) rotate(-8deg); }
            50% { transform: translate(100px, -80px) rotate(5deg); }
            75% { transform: translate(-60px, 120px) rotate(-3deg); }
        }

        @keyframes float3 {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(80px, -60px) scale(1.2); }
            66% { transform: translate(-100px, 80px) scale(0.8); }
        }

        @keyframes pulse1 {
            0%, 100% { opacity: 0.3; filter: blur(80px); }
            50% { opacity: 0.5; filter: blur(100px); }
        }

        @keyframes pulse2 {
            0%, 100% { opacity: 0.3; filter: blur(80px); }
            50% { opacity: 0.45; filter: blur(60px); }
        }

        @keyframes pulse3 {
            0%, 100% { opacity: 0.2; filter: blur(80px); }
            50% { opacity: 0.35; filter: blur(90px); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1000px;
            margin: 0 auto;
            padding: 60px 24px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 48px;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-glow));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.3);
        }

        .title {
            font-size: 42px;
            font-weight: 700;
            letter-spacing: -0.02em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
        }

        .title-static {
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .title-format {
            position: relative;
            font-weight: 800;
            background: linear-gradient(
                90deg,
                var(--accent-primary) 0%,
                var(--accent-glow) 25%,
                #a78bfa 50%,
                var(--accent-glow) 75%,
                var(--accent-primary) 100%
            );
            background-size: 200% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 3s ease-in-out infinite;
        }

        .title-detx {
            animation-delay: 0s;
        }

        .title-xlsx {
            animation-delay: 1.5s;
        }

        @keyframes shimmer {
            0%, 100% { background-position: 200% center; }
            50% { background-position: 0% center; }
        }

        .subtitle {
            font-size: 16px;
            color: var(--text-muted);
            font-weight: 400;
        }

        /* Main card */
        .converter-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 24px 64px -12px rgba(0, 0, 0, 0.5);
        }

        /* Drop zone */
        .drop-zone {
            position: relative;
            border: 2px dashed var(--border-subtle);
            border-radius: 16px;
            padding: 48px;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.02) 0%, transparent 100%);
            overflow: hidden;
        }

        .drop-zone::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, var(--accent-primary) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .drop-zone:hover,
        .drop-zone.drag-over {
            border-color: var(--accent-primary);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(99, 102, 241, 0.02) 100%);
        }

        .drop-zone.drag-over::before {
            opacity: 0.05;
        }

        .drop-zone.has-file {
            border-color: var(--success);
            border-style: solid;
        }

        .drop-zone-content {
            position: relative;
            z-index: 1;
        }

        .drop-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 20px;
            background: var(--bg-elevated);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s ease;
        }

        .drop-zone:hover .drop-icon {
            transform: translateY(-4px);
        }

        .drop-icon svg {
            width: 32px;
            height: 32px;
            stroke: var(--accent-glow);
        }

        .drop-text {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .drop-hint {
            font-size: 14px;
            color: var(--text-muted);
        }

        .drop-hint span {
            color: var(--accent-glow);
            cursor: pointer;
        }

        .file-input {
            display: none;
        }

        /* File info */
        .file-info {
            display: none;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: var(--bg-elevated);
            border-radius: 12px;
            margin-top: 16px;
        }

        .file-info.visible {
            display: flex;
        }

        .file-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--success), var(--success-glow));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .file-icon svg {
            width: 24px;
            height: 24px;
            stroke: white;
        }

        .file-details {
            flex: 1;
            min-width: 0;
        }

        .file-name {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-meta {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .file-remove {
            width: 36px;
            height: 36px;
            background: transparent;
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .file-remove:hover {
            background: rgba(239, 68, 68, 0.1);
            border-color: #ef4444;
        }

        .file-remove svg {
            width: 18px;
            height: 18px;
            stroke: var(--text-muted);
            transition: stroke 0.2s ease;
        }

        .file-remove:hover svg {
            stroke: #ef4444;
        }

        /* Preview section */
        .preview-section {
            display: none;
            margin-top: 24px;
        }

        /* Program section */
        .program-section {
            display: none;
            margin-top: 24px;
        }

        .program-section.visible {
            display: block;
        }

        .program-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .program-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .program-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            padding: 16px;
            background: var(--bg-deep);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
        }

        .program-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .program-label {
            font-size: 11px;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .program-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            font-weight: 600;
            color: var(--accent-glow);
        }

        /* Roles section */
        .roles-section {
            display: none;
            margin-top: 24px;
        }

        .roles-section.visible {
            display: block;
        }

        .roles-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .roles-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .roles-count {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--text-muted);
        }

        .roles-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 16px;
            background: var(--bg-deep);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            max-height: 140px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-primary) var(--bg-elevated);
        }

        .roles-list::-webkit-scrollbar {
            width: 6px;
        }

        .roles-list::-webkit-scrollbar-track {
            background: var(--bg-elevated);
            border-radius: 3px;
        }

        .roles-list::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 3px;
        }

        .role-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: var(--bg-elevated);
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            font-size: 13px;
            color: var(--text-primary);
            transition: all 0.2s ease;
            cursor: pointer;
            user-select: none;
        }

        .role-tag:hover {
            border-color: var(--accent-primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .role-tag.active {
            border-color: var(--accent-glow);
            background: rgba(99, 102, 241, 0.25);
            box-shadow: 0 0 12px rgba(99, 102, 241, 0.3);
        }

        .role-color {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        /* Filter indicator */
        .filter-indicator {
            display: none;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid var(--border-active);
            border-radius: 10px;
            margin-top: 12px;
        }

        .filter-indicator.visible {
            display: flex;
        }

        .filter-label {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .filter-value {
            font-weight: 600;
            color: var(--accent-glow);
        }

        .filter-clear {
            margin-left: auto;
            padding: 4px 12px;
            background: transparent;
            border: 1px solid var(--border-subtle);
            border-radius: 6px;
            font-size: 12px;
            font-family: 'Instrument Sans', sans-serif;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-clear:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--text-muted);
            color: var(--text-primary);
        }

        .preview-section.visible {
            display: block;
        }

        .preview-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .preview-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .preview-stats {
            display: flex;
            gap: 16px;
        }

        .stat {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--text-muted);
        }

        .stat-value {
            color: var(--accent-glow);
            font-weight: 600;
        }

        .preview-container {
            background: var(--bg-deep);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            max-height: 320px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-primary) var(--bg-elevated);
        }

        .preview-container::-webkit-scrollbar {
            width: 8px;
        }

        .preview-container::-webkit-scrollbar-track {
            background: var(--bg-elevated);
            border-radius: 4px;
        }

        .preview-container::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 4px;
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .preview-table th {
            position: sticky;
            top: 0;
            background: var(--bg-elevated);
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-subtle);
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            z-index: 1;
        }

        .preview-table td {
            padding: 10px 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.03);
            color: var(--text-primary);
            vertical-align: top;
        }

        .preview-table tr:hover td {
            background: rgba(99, 102, 241, 0.03);
        }

        .preview-table .col-tc {
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-muted);
            font-size: 12px;
            white-space: nowrap;
        }

        .preview-table .col-char {
            color: var(--accent-glow);
            font-weight: 500;
            white-space: nowrap;
        }

        .preview-table .col-text {
            color: var(--text-primary);
            max-width: 400px;
        }

        .preview-table .col-track {
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-muted);
            font-size: 12px;
            text-align: center;
        }

        /* Convert button */
        .convert-section {
            margin-top: 32px;
            display: flex;
            justify-content: center;
        }

        .convert-btn {
            position: relative;
            padding: 18px 48px;
            font-family: 'Instrument Sans', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-subtle) 100%);
            border: none;
            border-radius: 14px;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.3);
            display: none;
        }

        .convert-btn.visible {
            display: inline-flex;
            align-items: center;
            gap: 12px;
        }

        .convert-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(99, 102, 241, 0.4);
        }

        .convert-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .convert-btn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .convert-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: translateX(-100%);
            transition: transform 0.5s ease;
        }

        .convert-btn:hover:not(:disabled)::before {
            transform: translateX(100%);
        }

        .btn-icon {
            width: 20px;
            height: 20px;
            transition: transform 0.3s ease;
        }

        .convert-btn:hover .btn-icon {
            transform: rotate(90deg);
        }

        /* Processing state */
        .convert-btn.processing {
            pointer-events: none;
        }

        .convert-btn.processing .btn-text {
            opacity: 0;
        }

        .spinner {
            position: absolute;
            left: 50%;
            top: 50%;
            margin-left: -12px;
            margin-top: -12px;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            opacity: 0;
            animation: none;
        }

        .convert-btn.processing .spinner {
            opacity: 1;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Success state */
        .convert-btn.success {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            box-shadow: 0 8px 32px rgba(16, 185, 129, 0.3);
        }

        .success-check {
            width: 24px;
            height: 24px;
            opacity: 0;
            transform: scale(0);
            flex-shrink: 0;
        }

        .convert-btn.success .success-check {
            opacity: 1;
            transform: scale(1);
            animation: popIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .convert-btn.success .btn-text,
        .convert-btn.success .btn-icon {
            display: none;
        }

        .success-text {
            opacity: 0;
            display: none;
        }

        .convert-btn.success .success-text {
            display: inline;
            opacity: 0;
            animation: fadeIn 0.3s ease 0.2s forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes popIn {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }

        /* Particles effect */
        .particles {
            position: absolute;
            inset: 0;
            pointer-events: none;
            overflow: hidden;
            border-radius: 14px;
        }

        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            opacity: 0;
        }

        .convert-btn.success .particle {
            animation: particleExplode 0.6s ease-out forwards;
        }

        @keyframes particleExplode {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0);
            }
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 48px;
            padding-top: 24px;
            border-top: 1px solid var(--border-subtle);
        }

        .footer-text {
            font-size: 13px;
            color: var(--text-muted);
            margin-bottom: 16px;
        }

        .footer-logo {
            max-width: 200px;
            height: auto;
            opacity: 0.8;
            transition: opacity 0.2s ease;
        }

        .footer-logo:hover {
            opacity: 1;
        }

        /* Responsive */
        @media (max-width: 640px) {
            .container {
                padding: 32px 16px;
            }

            .title {
                font-size: 28px;
            }

            .converter-card {
                padding: 20px;
            }

            .drop-zone {
                padding: 32px 20px;
            }

            .preview-table th,
            .preview-table td {
                padding: 8px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="ambient-bg">
        <div class="ambient-orb orb-1"></div>
        <div class="ambient-orb orb-2"></div>
        <div class="ambient-orb orb-3"></div>
    </div>

    <div class="container">
        <header class="header">
            <div class="logo">
                <div class="logo-icon">⚡</div>
            </div>
            <h1 class="title">
                <span class="title-static">From </span><span class="title-format title-detx">DETX</span><span class="title-static"> to </span><span class="title-format title-xlsx">XLSX</span>
            </h1>
            <p class="subtitle">Transform your DETX transcript files into Excel spreadsheets</p>
        </header>

        <div class="converter-card">
            <div class="drop-zone" id="dropZone">
                <div class="drop-zone-content">
                    <div class="drop-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                    </div>
                    <p class="drop-text">Drop your DETX file here</p>
                    <p class="drop-hint">or <span onclick="document.getElementById('fileInput').click()">browse files</span></p>
                </div>
                <input type="file" id="fileInput" class="file-input" accept=".detx">
            </div>

            <div class="file-info" id="fileInfo">
                <div class="file-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                        <polyline points="10 9 9 9 8 9"/>
                    </svg>
                </div>
                <div class="file-details">
                    <div class="file-name" id="fileName">filename.detx</div>
                    <div class="file-meta" id="fileMeta">0 KB</div>
                </div>
                <button class="file-remove" id="fileRemove" title="Remove file">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>

            <div class="program-section" id="programSection">
                <div class="program-header">
                    <span class="program-title">Program</span>
                </div>
                <div class="program-info">
                    <div class="program-item">
                        <span class="program-label">Programme Name</span>
                        <span class="program-value" id="programName">—</span>
                    </div>
                    <div class="program-item">
                        <span class="program-label">Episode Number</span>
                        <span class="program-value" id="programEpisode">—</span>
                    </div>
                    <div class="program-item">
                        <span class="program-label">Episode Title</span>
                        <span class="program-value" id="programTitle">—</span>
                    </div>
                </div>
            </div>

            <div class="roles-section" id="rolesSection">
                <div class="roles-header">
                    <span class="roles-title">Roles</span>
                    <span class="roles-count" id="rolesCount">0 characters</span>
                </div>
                <div class="roles-list" id="rolesList">
                </div>
                <div class="filter-indicator" id="filterIndicator">
                    <span class="filter-label">Filtering by: <span class="filter-value" id="filterValue"></span></span>
                    <button class="filter-clear" id="filterClear">Clear filter</button>
                </div>
            </div>

            <div class="preview-section" id="previewSection">
                <div class="preview-header">
                    <span class="preview-title">Preview</span>
                    <div class="preview-stats">
                        <span class="stat">Lines: <span class="stat-value" id="lineCount">0</span></span>
                        <span class="stat">Characters: <span class="stat-value" id="charCount">0</span></span>
                    </div>
                </div>
                <div class="preview-container">
                    <table class="preview-table">
                        <thead>
                            <tr>
                                <th>TC In</th>
                                <th>Character</th>
                                <th>Text</th>
                                <th>Track</th>
                                <th>TC Out</th>
                            </tr>
                        </thead>
                        <tbody id="previewBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="convert-section">
                <button class="convert-btn" id="convertBtn">
                    <div class="particles" id="particles"></div>
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="16 16 12 12 8 16"/>
                        <line x1="12" y1="12" x2="12" y2="21"/>
                        <path d="M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"/>
                        <polyline points="16 16 12 12 8 16"/>
                    </svg>
                    <span class="btn-text">Convert to XLSX</span>
                    <div class="spinner"></div>
                    <svg class="success-check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="20 6 9 17 4 12"/>
                    </svg>
                    <span class="success-text">Downloaded!</span>
                </button>
            </div>
        </div>

        <footer class="footer">
            <p class="footer-text">Supports CharactR DETX v2.0 files • Exports as Excel XLSX</p>
            <a href="https://media.transperfect.com/" target="_blank" rel="noopener noreferrer">
                <img src="data:image/png;base64,UklGRmRAAABXRUJQVlA4WAoAAAAwAAAAAQcAmQEASUNDUMgBAAAAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADZBTFBI1TMAAA2gkG2bnsYCBRQFUAVQBQQFTRU0KNhUwaYKNijYoOAEBRsUnKDggIIFBXuFn8w733zfN5NuzkVEwIIkyUo0h7ewIiiw857e/8HD/7+H//Twnx7+08N/evhPD//p4T89/KeH//Twnx7+08N/evhPD//p4T89GKWH/xS1UH36y8gPnuaD+dOihY6H+jSo/iIxh+l0/jR/GiwMX2b+dB3fg/p0uAzyr9Pxc0un2i8Xcz6P5iPzt5lM50+DaDB/2p3quj78zaGneTSfzlq+FjK+B/Onq1ze1Ye6+pqh4lYYVpkMSt7vRtM5q3zBFuIosv5qi6f5fD6u6qr6K2NxRlHUotPaj+/5dB7t6qpS2gqNpFNldUV+MaEbL0E1qA4Hfe745O4Ex4LJz6UbJtlHLdT2baV7M9jlr4iTCdlXHEXz6KUqq8NfFZszilvFEeGuUXQsy5qeHSlAv6TTktNvs/MSRINoOq4rZYyQFpMzzcVpO4lRCkmxfQHap84+39ZD+FYcnYvS8eWeM3o6DjeaIJNHSMw4ahkhNfxQJTejgs2lPBz4aMl/hNFnhlgP4tj6sJ3cjep44e47z+J4XBY1MTsKPI2KnP3OoyjaVg3/VcPob3tex5W0G7BJTqq7hdLYFVdI4nNenlxypBmjK3ejCR7rumKQvLBgToiudIKv5IQTRYPpdDrdHeqQDGnRSsKmx7mZEyfjoug0jp7XKD4XhQ6CJ2m1Ql2+7UoIfcayybEFmC6cXu90WeWcMpCcs6hr9tCxKr0lX9yrFNfkql1ZKZ0vpvmgjpmMqCQ55mUoe9edGSHJtlCA300XrWzmXIvja6tE6z3yiXOzO07PDVNQZQxE8UtZXrhUqOwaRxdnXoh24C70EacnJn3Ji25TnfGeDOVnYt6Ym21vy7vww0IwufR/Zq9cmELG7aK7VwbiZZH7zF3FwZlXKnxXVB7TacLugUnfijy8VqRlYl5WhLcGQbiTx1t+bkuFdeOMD1PIlpcVXTqS9HipjQmYjnSfV+G7xnI0pasOtJJKduzcpF+2vy2wCLIJxGnLHG40BU4rSaXOKBhnZchkDaTPja4UvmvdfCXfZY6eCxapzsZQd2xVxMp2VGxj7caE8cZc/dO8VopbvUuVUGQ29s8O3HSlVE3NRGGfzk0xFN+Vt7zoNiWn31apVGaXmp/QVfN2aCxG23zGVe9SZ4dzegiZlXycBkQyDquil5y/yvQcnI8LPxNk37BfkW0CiOImY0ugsbNypXSKvE05V73rozFn1PEyfha5R5gEV10pOD/VqLQiHpdtOH6IK/t9E6kaxYgluJQiBAx5Py+pZ4+B3Oxi7A6Wh++VyF6aKxE2viIVg7S6xjSk6Hnf3xoXX1AtAk2wdSHQQ36Tb2PeWSQjOxdKvljrxWtX4RHeV+IiXILmQ8emMyB7C2EuvsBYtNH387M4GyzBHs7lVQTIO9+mUvHF/aEbu4OmY2wQH9Pg8RUF4zELcY9Lt9nrRRo0S4uZaajGlxl5KrNawRf/mN+6KcjQR7g06cFh4ysKRaSvfCbtcSk2eUgtEiNxH5EoXmeY8aQdl1ukobNO1WPyhYRrX2702etTnUOoY5zv8hDcTSKT+/HcTATQbQ4hSt2/iTRibwu94JF2GjLldAmnunXShwWxKlTpMww2iaq+Kok8fJyEH/Z2KTTD2lOjSd60MPSP2EihxSTqDLjcMpn8R6JbkhwJAveuPtTN9EbGif92g2g6jaieuvMPAvtKYpFoE64JG1/R0j+LuASIbxJ+LpZjsZGY7EjCt9wQptofZTiMHPCj+jx4mj/NLzxYkeUmvwJ9WygXe84UohYj0nRJoIe9tJjVqDocqvp5HsUEb118eV/NC8FAGymZ7CjGEnLlfIPYXaFXRv+pPtVV/RzFC/vCdCnSxBD5tsXlllIldCwU28nWZizz3/aKV12Vz0ljwVpK73+ILrlItLwvq6WQnV22DNlD2PPgqtwnyUyDwvQbc8rqbZHnW6tl5qSWAjP/h+yJK8qxXcfF9A7BRSaMRAhWH8o8xIcfh5NeRmhRjJN3y8J0edMxMcTlduVJaFIetcLKt9oj/3nzCwg7XpJXOPzwn+RhYusM+Yw15SIhASOhYFWT/OG0jYMhriBVxhS77N3GL19IeCYMTiNZuNx2v3cj1CXiNC64+e6g4rLYJykWdxFiwrgK8r+pal4JhZEIs5cSofXwrrcw5Cdmx6YG1aIqL5GGxQ3hcutp5siw0i16Y0dPXFGskJW1bubV0bM15w6UqSaUFWIvHXyAN49L2O+Qvn3HJdAbs2CUvaWD4XKLNXNWghMabOKCFqU4r+6GfH5dMZ5CuVyJVE0mJdZl4nf3tKvMST5VcE2hr9P5CDxcd68RT9+WEzgfc8vLMYD7+ux2lpvQMM4VavHdrsLS6YpB7Uq6mWxp4f7LLLhO5FDiXkt9m2JfU/Xe/Gk6nU8dgLqtAhZ6hjYjI1kv4GeTIyu2YPQoLrdcfI+dA08fex0Ff/26/By3K5v8tY1//FZPtrwEA/CYhaIcpi+Td6aq6grl3qfDoT7s5/MowgAzcL7xJxzR11zz33j1jna98BB9FBn/NtX4godl7oCLcVdSaF6OTpcO88kdV/lG+nWn+NVn/qDmJz8gSBHFxmZOkrTUy1FScCQTIF0UTYo2Ra1vNYwuiBdUz+BP5gikYfUYLt/RsdxMoCXm2cdxuf1S9+Y0SAEP3B9MZuJYfbtDoaEloU/Dp1vZsiQlIuHoipqcQyJteD+4AujNJ7S2+bOap4JHUSprJL+66PlNNyirqlzGlh1tum6nWOBKCPbaH8HbohdVCB24FEcjYvLZvpgMBvt/xImxp/kgmk6oA8NHp6qYvmUKVwC9ehyhgBkcFeVPLuQyKeUkyt0zp5LybYGJ/F9yfbYsl02xr31Mxezx2tDz7qaS3JI+lPTHO2UlvMTgxwyuhGCMfEczfO9wXaWCcytDWNEgp0Tk1bfGHeX8mXfDaauDwVNFo4p5GDWqGKbYnWGoKGt6R1koffj9gYMcN/eEQbEvWPNkAM8n5LJtE87YPrUnL60yFoTbkZtKCKcjnYrTSkZKWjoI5zBWUlB/0M1ObDqPT+wMLGJP1a0GTaOKDSsfZ8jlVXvJqG3pbiiwWgLYeRdrzop9l9mEZKeucLCkFCb6TH43K1xu2QhXehC1seBIUWbGsuk9Vdu0ES2+a5ynCpefbZ52W/ymIKLGzUJ7nMTxE1Nmy2bSCzR20qibneOv2n3HKiGeOSj7dnKD4iDCEa7UILTVR7Q4roj8fPdbwyJVuBh5uOGr9KNOJXBwJy7KJMxBxQz1HDTBnaD7YysLVxPsASnYlpZDj/nTCPnZDo0iJumZdhFsUfkC4EXxjXmVHps0ICJVTLh1JXoMpNvbVBx7/KYAq0C0ixD+ZOQ5QIAPw/8PFLJY8geDoYxmj2DfZZ5Y+JOUBecWku6vhw3GKQ3o450mLLw/eDs8EjX3hcY7HRaERi0oexl5Ds6NWml06t5kfHeQruEC1GZ5CpMYetD/PaSybQ3M97yJlGjxf97pHAN1laAzJCCqhdFoiU+Iq9eLDtNve5nqhVeWdxfYiUZxBRueLegUOTTw0ojkf7tyWsnnUyZM0A6B6KfUwCYtj4i8vpDclpDqs63hu+LO8MrybgLIJhzuztLIpiuelCx/ElES7HOm1Z61p7ji7ieNdeXz5c10RjBaEjohJitN2mAcJhwDyJtFG+pBV/gDpRxi/D3XHB9/zNlxFf3PEym43NjvfkVxjo9aKfNNrqG3FhLryuty43Pi1Z15hn0ARRqGeeIJ+7z8fuc3+tVV6FbyQaZPxTEIjlXH3op+ak7LDY0HPd9aKTOv9pZvbGh0MGLjwPPVwl69LWKcXlAqBMfw4A1X3Td7XX9VV4AhxedhghJAaoYt9rD/d+OiWI6oSs94qoabCaqOJDplPZ78xRpXxmIDxBkxFoOyqJTCtftGsBk2nzGIVAuUGJ75MTdsNW8Qv8JxJ76PRowRQwUQA0i6w25IsLfF6PWbkR7no7SufHSextVAIFv8HiD5GFkrJsND0JyC6l3OilO8nX0MNCSvq7bjCZKHueeXUWKRGnbdGcTllnLR0xsjF7nwnxK1Rc9bV/7xL3JLZsw9uckW/4PoxdzD9TLoEH+oqzHCGgkK4P18JIfdO3YQMUz/BnsCEv2rRKNUgpMfrSv0Mdh5PkCyNHwE8xWFTEv04q45FR2IWDB5a84wwqqD2iKgIC63GK52vFbfQj98LBIDTDX+yp43pYFiXbWNTHsKmZYoR6ez/93bflPXQ5nm0Qb3bhH94xkGSCNHOX1Gg+8/9oXsZ8Gf/LXFA28vW3xP9qZ5mLWSSgQ72j9uCiA2Jgx8VxAuN/QLVwtUGhS1QuSxZvtuT55Xjs8z65F9CLO2pUSw4/7RuN9H0EhmpgBiP/aXIb7CG5ebIMHx88rXkF++jU+CJdETmmrotUxoAtHi+yZIyKVf1YgT2mlITBbKnBdBhiz26cLEWGBcbkHnwxfBj4JXaxHuqlGtI2ze9w/5kJjOAkCD1RaWf0GlAOaGL7EaYbjcgpxbSVMtKxucG4vOTlBQMm82yFN49r5yHGR0KYAnQWT8E5gUKgpggh3ZZP1VMXZgSYytyNEZ8d4SwawW0wSGtdesK6+X2pEEyaxzKYNlm6IvOGHSQkoBzAEpKxCX2+D+3f9AzzcsJBsbmEfaa9aVjoNXdEpWkB1qTnOuLwtitjc2xZ6ZsexfJTkbQU1g/I6Cc28qsaYYqAjsa5+RPQyB9ylA7ooDsYrxv/++gIgkwm0tjVsg2SxwueXMT4HGxbJaqjMSrdfTWlcmwkSe6WhdSU5KDjOvF0mZ4lfF3qKq8Fur8QW8bR3gWs8kgXOTZAZcEKIgZeQlDxzZ4jXndAC+sCyILwPZaHLs8MPiJlD5LHG5Zc2MsL4cHAqDbprzSc3JBO9Ycejq1tVfrnbilCgebqz9BaIO2zTS56dYpVIJny/KX9bVFxR97bQ1fyxurLHB5ZY1PwX0658zofhkuB7Q0f1DYdrmXxp0YvQ+VvvTCDhMHL+NZJUdgD8drkr6fiyEAnChesAy+VtCpsJWLBHeV06KUHxCD7wRcS9iDBP2ZSIOlxsS9C/w+dYSMiCBnKThosMtEh/SMPkXKG2g1Ku6JIoQN/zEw5sgLrewZTVDOVvKfwGDr/CyaqDCvVQ2HTrMIfisdSwL4t8vhH9YNx8sbjzujUn73bss9BXUAI63KDj3Oj3JbaDc3HXio6o860/WgSNHTkG2XX4hvDC1jA8YBJz6bNFguNziFhic+zMW2VhkDZcbH7mOAke2zKz1ki+U7TBx02MDmQ9hcW8b9nFeyDiwNQ/LC9TeWyUCm70NXPCPl8Q7BYmtkNMhZkgdgsRfbY999JWAloYF9OUAsYnE5SZwymzh843ZKqtW9+HjMlmfxV5l5plwkX2Oie8NKXsKsXeKL4QXGzYHClms/WPFXZ8nIibjIxiSw3fU3NsX8jyOSUuMBPJLp6uk8qipcPb+P+t6giBJWSJ45wuBsHd+cxHqsMpn14C43PJuxWqBBiyKWnQXZJYXw6zyCFkH2HwvRuzb4PFXY7z1zxfC3qy3rYHYCCHZBPq6PlFw7u21+kFyVQiklWSXFW/4F8OGUvsyxCD59zXRgtFA8KnkLNQNUpQQl1ug13Mzwhd5mtElJZZgxQ9HnXiK+BQzBRnZ36ouSFwcpGxKVEEhi4WR/mkjGJJNSGPvzUrg831cDi6xKsR65TlrEHt8kGJiTZ5vCTyJQbJnSJHnldoMzM7i8uxPsNofe0FTiMHltmf0BXqFXt9uFmEzZdwudqfLllWuvmhqv52Yxvaf36VITCBFQoS+JI6KyliQOLc/SXCoMUAaiXfk+P3yfSAtYNgcXHphJOgWjtNxXkjdnY2a5nXZQlEybh9LC5PtgIIu8LxXB52tSwgWtw0kGwNcbi6KwzMMzr3hJwUI+OqmuK7a754mu0JxFtz410OGTN4OTJ/9FSRetUAmD8R8FmjLRaoTASBhwUYQl1skw/uYoYIwq+UtOfAm6hpOlqXAM7FR0+ytK2eYlFRkL/alW1EJQau5y4EmlkGhrRfQExciFCQOiksLlsoz0f1izKqlGUb7V6Gb0OBdo+fbJCexH6A6U6ldVRqokbFNMeFilC2FC6dGEdYbWJPEYUJF9k8lZivYh2y/Bl45nPBG/qtIv70hl1QDXG77bKB0PQLZxSYWuMTbW0hmmjPFx8JtTqpMHWdkH2DzuRfxMuDsk0m4fNpn6LbYlAMd5CXSudioffD7XAjDjKKbjAg/sDx5lzUcHzzfKhWoBUQf75RcJ1lWZamqdMkJrCuPq8eXx4fgpoQJ17UH7+neBImyCRzN/845a+AiPakaEbjcVErABgbnfkklakrD/GYvsjPFL2WuEnuBA972KfMezxAwP98outOX7Se1CmqQ23gWX98usGnvansBcbmFyoQzigf67VxIvAZFEw+1+JqQrhKnap6JJMDm7yphY20KnjAXYp88dThi4xq9DXxj0vFfLi0B/3SCyy30Dr3A51uz1F7t9eXk7cYxQHomXSr0bXQ9H1UZcBm8Fy2YpP3HJbEJXA5Vuqe8KIxUG23zHWxE4MXU4kIEGG8OcbklQmKjjtm0FimktnlLuQJdTuq5EG2cEJlOFG0YrNk5i8K3DDFM3NtYUFfNNbuh2oTVhGBxUwDS2OByi8QDBWXaOr3qrwLLMV6y5pD0uxf5SbMUS97+RdXr8+7LEwhCs1dnUZDMShjALk296X5Ew0ekdcfYCXDLRAESY2M1AhupCwzOvY44XQbSW5J/fHNQ7JVus4OObhBOWdHK+4aimFK7alLBvmb+PJ7RFse2euwPNprzzN6AcIzLLRIPFJ6fQqgmkG0L6w9B9yzbFbxqj9k8n+1ZtTYRgR8etTing2g6JX6o1oHAgrtFIb5iXq55FBmGNGYdXirdxGBxq4HLTZYTu4XPN769EBKnjBpmLlaSYVapA4V0vXgk73vItiRNKLJnFT9Dwa78IoBWe8KPd/1OAI/DZOM7I3BJe/6pAi43sR4wRG/Jj30hVnPOblbIA5HZMDloMtHQ1XCnyrEMG2/Sl62w5WPiURbN07yuMKBcjkyQRSEHl5vRlVxd5BymThRNLpuuK8VOh9NF03kUigG2j8GX/5/8F2ztJvZZFC5xuQXr+J8oOPf2Ys1JXkneHRzmo2zyUR3OH2D63RVwc+YkAbbBnDqHdhsOYJvYYP79l+1FaSwQVEu5xuUWmvaSbEY6zE9hkn3FLk2sajLAC5W+NSCrzujdhNlQmb+X0xxhq8JYz/MK24S5n39XXiRHY7Rtj8XtHJdbbNZLhR788xoCEnw18nLZIHaR12TkYwcGs+RMmSRoXt++YF5BM4h5vQgAM9zjcks93/onGtNb3QoHuUZxmT1bHRq9VOsiF50MEkZFBkQJc3+VXndCRQ4Wt4a43GAK0fE7GtIb3kKliD70NklmxB/KXppOhjMrMfUvBk24RHVWq0IWWPW1cIyEmQlCAKclDJebl0rxDINzb5lOAUgMXFAMkyYSSdzZwAuwuys8YwLeMK+Y3pK/HL3USX73YQw5QGxq4nJDhu/HDL1ArfM+CHYOF8UybkC8KDvzYcJMl5/x9C8GTbhEO26qwTicf1EQJhTT+yx3OVjc0nC5uV3UzQQ9X8wR8dqJu7qslvEraUFGxOpqFTz9iyGjLWsIUCffHWM9KcW87mbEkrnlt0AfrPbGfp3hx/HA5RZ9PvtFejpOuQNDkWj67DauGfXxfIVMvsAvH3NcfuHy01fBWluCgyAgNha43KJ9Ok0NHyrEVi2IKRqEIs9JghRmoApDCizuShRZvkImX0BPniq7PmlqPVIOXw9rgrC4WeByy8733MDg3C+pJkynKJ6TJhRJs1TrgktfUL8uSL1fKxQyIfzmODx9Gq/2bFk0LjcXGQODo3w7m84nvzCjWqbGM6H5szury0UJGRowVeYcNZLs32Diu/bU9dNuSsx+48GCCTBKROFys720y1dUhm1aKpu0CEXmw9RkpeCXi4O+lTK0r76Hy9k8dkMYPrrtePUQpsfRRxRQj2RZmYF8+WNxu2yOC7gaX/j50BTQDExrEx0szbepIRKJXy6F+j4ZZZgMfcMyMg8xweiroxSfo1OrbGYS4C2UYJhKtw0IySbcqou3duDcyuyeFwa4Ujx/1jkMGz/PSBIsHqPsP/1YrC4BiMj+UJ38uHmbusV22x6LmxEutwYLpBFsWCrSDOzC7LJCsDh2OGT8oAGDJWHAVHrxlVyI6Ng3iUiqG8fCAn3W0LidFCxulweBRNxLKd2t2SCZoef7aKwm7VbwEhLHJYjcBEwaKnHHHJiCMIDAaMKTdOKpBW6w5TPQPRizbzFO2soxnEGySTwwQcxu9wM933MTINJqJb8rykAv19lSk7HmYAteGZbpv2Fy7PwKeBtkZKlvHrtiLT685BfMFAjJ7MUssbgBsRFMVqc0Ljd4Ncdoeuf3Y3M+rVY+vtl9rfTk8jO8KmN9+ak5db54cb9/aG0MR0G+oyrF2BkoxQr76hvHbjgQi5uBnbccuWn4O5pXC7SoYV1rxYeyXXFXl4h5JdaJwz5OFlZTGetNrvBEm47LSRnBkgM81wT/B8UbRy8LlMOy1qhHtoyZFyTb655DIa3zxMvPGWr2NwBnajGiZHXfCd3Hc+WsoDnmE2ArwuA4kI5Z8h5hkec+aM05yuBNOJVvHK3hLs7vY/60XyyUiOYHcTwIB4UgvdxYULlpPJl6MfF9ObLBvRPUhwWpi0DgguBz/Mk8Jcmj/6A8vmEDR9PJu35s7k0jKVjcPGTc9h3E5ZY/sNMKjeyvdVDoYbt4c7sXo9rOhMfnq9LvueN3CUw2boFhGXBE0HTfLtDIYNJF52d1YemidiYGSKPAyG4K5vDzKcbyk88bRg8a845KEJ2HHOu6QYbwfu74xw30uG16VKjZHsN2DAqUdXXgLkwuvJH4Ld0w4cgWiM01JBvkSixOCjDQ4xUcErKLx3b5QeJBBFbvzhqXihXmla8H1an2ciUYNIA+23Ml0aQB1ozXn29gLPjcbHbfLrBQYMuU4aUECYq64HKzuR7PjRgDXdz7QjN97O3G1sHSel3kb0wMalZBZ7SfAoM9lClFV7gRQdOBu8CyhgY2kydhLZ8hNJ5hw0YFu2E1c3M++YDiqCY+rOndDblJhGityWugv73N7BlIdgpX6sJdmJ9txbIrsSrS5nEQEJdbBWfmZuLkfAqgqXLhQyGWHElj9aOcIpjIpAqeDSoNiurYebsykJl+27vOegD9rFiZ7582YgDJhh1YBTGWbMjPp8O1KuGUPPKk4/cQI1RN27fjBMGc4q9IAzpah69wVpuM1iAZ9cXlpoulZSV+Pu04PXQfx9T2chxo7AEcoB8jigOGGds1DQ0Q0KOzd32k/AhLsb/MosZocwVCsukgxjYW59ON07NoRj4hBVAdDDYQxine8jD792IaG5j/Si0KyzENT0LADdQJbIkg3J6Icj2mxyfBuNz2ZsHw3Wp+CrXASXMUoDHgfUTj9np8OHM8BBsQ0OPLoos+FwPE4m7/nSxiVVijRl2DnPkpeMVzIU1mF7LsgTgQhiJohBpRNJ24y0l1L3kuBpbrVbSX6TsLxlGED7Soa1DofBR8HHQE1AGfK7cxgDqgCBo+Jhbz2VA0nbiLWXUv6GfF0EZ+skjWoNAc9ahrwM+nGIEaVBBxIb4jaDUJsy4Ki50E778Dd53fwWcyO3DH4mZSsUahOSqyYBb+pgE9UKxEC/0X9F0UMiLoyG4+so66GMTexwTt4nRk6+05d36lwvmKHE0d3MQn/VhSu5P8FMiE+imOhhA9OKOasgfUgiEMZySB3U7cxWkgY/w6wYDYeIKWgLjcWgiy/Q80arRK9ZqyRpd/oYDMTVAyUISId5zEYFcE6MeDaq1uldfwQObSgiFJnnuDuNxqjPAxfL5lohZMRwdRkPNGAhBMThFoO2sS2A378D4YHXOZGGNvWW4ZgZbQ4CmpcXB0GapwPqxIZoJtBD+APkVXgOkzZaOtUHRJeKYaB134d8GJ3UxaSXvrgcsN1rGv4fNtS6V2nkIP4j6g2APXsloCFToPEN2IOm9JVIjEYHtMBo0PKvy7YL8DXyxuRntTlNIqot40FZ+oapvXOmljT153EakVE95+175LKQ1zdwEBsQc8P7JUjts5b9oShgn7MifU78AViM1gD7p/4ghmVtGDcaYVyi63yUGnHdEoSeB3vbUXI8Llw15iucJUc7QkjRNngIIa5R06ox+7VJuJB+5i0IJAbDBxhWRTRJitG3Bu3uWIHTlbnGJyivBq9gawRAvOwPrVgs7YMTw7d0/DrnLuWBjZS2NuTgfhuNwEbPHcTDAHKjifXGYw6sLZ4udXexnx6aV6fGGqOc4ZOL9aMhF2Ib1g0vBtxkeXNWTXYEBs/xiJf6PJIH95R7WDlULBh6nNEvjFiAQAmscq+N7GOQPnV1gtzOsV4DpUjkBshm/WHlLhi8utCedcwecb5yoSy0+Gl5QoMk93yU/Su8mQ4fsyLKHfBeZf7SuGWNzsjkw2s4oWyKQbVNP4sVdxzJ2Cu8G01uWMAjslvNSZ7TeqhevLuIR+F4jWQB98tkeZMT1bPNyOFDOrqJLqtBkpOUXTIuz2EQQtAevK4cVxP0ZUC88XsAT+oOZR22QyLLFtQ4bO7swlN+HOZxhNQEAaVUz8vICv3LbTvKPKc7v7RoEhHWRAd3IWA9O9JP5DS+B3wbVNDgnD4jYW53FzpFSbhSq43KAtv4XPxwsBlGv56L1NE/4lwxRdIebTJlo+IocMDDMILoIcXIJ+UC8X7mP6FJ5VXqkmoJ2pCy43eBuHcM6bgsR1yoPwMpSyPPgwpHHvFMlJN4mrOwoy4IvLF16CvqsBDEO7WAGxsbp0oHQ4LrBNZe7u26tSZEBJDw9SxXkxXlB0hZtP296s35Q5m90KG5Fc1GGf5A12PeeM2kxCxqkNLrcm81OoRKZpQgg2uoN+DGPph6FPG7NCsmcnsDRQQOi2sh+GZ0zrsJ/5BXwui4MbwkrZfrMiVDwMF/CBlTk4lzyZ04kvUZQhhrx+XKYEXZtDGMJRgmbIOi2Z9NouXaSLTQiLRSCQwvUE4nIrwzuT7YhLEndssbgGUKBoQ79eiqIrFCf8wJhwMUwPjtlFdnGfEyxB3wVWpb3kLo4CYnGLoOUEg2TTZpwX9NcB9WQ/bWP3QxR1kXcLsh9FMKMIsvRDus7PMneo8T6lV6WIZAn6LhArZVPT2y+YfsySHWCuVve43CLUg6NZ1XVi3M+uQzRHrGoGziHUtCnDnFAd6GhIY4YDJgEW1iX0B43SVdGsuFwTt4TYA4i6c+jtFxCLmx2hEmI5whp1VN3n9vM5GsT5rS9o5/qKEupH2w6DzA0DaISX2+0aVyRfobdGbkoPyZbkEO5deQ6ntVHLBazSIJcSTS9SGJdbu4PTqzb3boFLVhy7Psu2KxQjUnSNQ+ZBwdGgfgyIV6qc2D6ME5zTBH3JE2hljl/h8l4GQGws7T/w561GEg7CwXm6nrnuawuHpBWvvkuVJOY3gELHQc8cnhd+nZxCDL8aN/4g2pU4HeflgYxNxNS+gBv/etB3wSOZtE0wIDY5mnkVg7jc6tgPaRPwcMt7WzNsi52NWuHAQ1TAbQdB5vZIlyqTphEpw60jPo3PVWmj996jJEdWZYeonuvdlz4ioWDQBQ56ttYfaGeigDTaHDwjk2bgPTQ5Bt5sO0lVJvzu5PoTbV6tW43I6eNN65zbGFK4UCBhDbUlAh8yxwdjWVlNmmbrDwLZcRRHu6quD+gwnkfz+eXa0L9ew1mvhc2M4Ss83QsHLG4pbGn3DuJy68P2Nz9dukiN4z/fZydG88QwR9HTePIparfZQRB6ih+6NPIHuXl6o/l8ujvVg/rUZnBOB/Mnd4/17TwFHaXLbcvW9kMzZp3icou6PGcaGETwHiJ60UfO4brOLb76NXrbwbo+wuhpMc6Rc4uR4WbXp/lg/sTk169uUtyCvwv0tn+kdLoTZr38aSMRkGzSN+nuz4ttnMFCDoJQiW+ZxZUlSxO45dTgQxMCpI/nwuSig71FYbY4/e2sXp2gC8piOZdsgNjE4nLrFPN3lyYKXdhs6XjlghIlvA2x0nGSrjBbxL+6wqj+nFCMZBs+jcVl/hWmmD9PdDmwVczffpzjfmyLlRJhtlTq0q1qZF2F3y2KEfOWcWTxHK4alSnMFg1e3aDLQWZ3W/B5glov0hoQl1upxU183mqlzM1JIDTPSjaxSomzhY4LeuREkq5AWzrLS5jxtv8GZ3Y7aw2F3IJxuVUa53lBj+nUpv2A2lGSnvNmd+qfkl4d5p2nDxtHFNK5SWcMsqUByWBOVjpuHEajWk6WN9qVHRzN6cMv9EfCckBcbpVivTs7ECiyW2isyUjjXVkdCI+T3NowFp+R4jgPMhGxM+QwwyiKAb84rD/sPl0ER8YeqZ8ciFw+vY2wRisQKGq3gNlOBJ0EcXRFySDJ5kns1V2gVKTDqMcwiqKCTFelmMhKJhjM/vbVKbrgGc/sgdjskUz8i8tNoKqsFsTs9viTECVjX9V1bQcTRSLFzQ6hToPMjc4mE2h2x/iHQGqAObqIYgvPeKZDFT5N5EWLg5DIts92Zw8FL11XlxQBsrfm8/n+VN3hZLQiZUyn0ZToq38M8L+uUC7lyS6RbGtbcjo81QD/faPYdqKuTewCiE3mZdu+g7jcOt3hZEM8yut4c2Ot0u36FN3hZOxv3ppb/EjskekA/MB2lH+OCL5aM29CoPne0vVC5PG7RxeszNq1BEmMmuJySwJQTSry+MiyrTCCVgbfokXRvoJiMialntgi88PkFFoxgyW/6iOrSt9ACPLrhJQCB/XJgdjaR45HcbmJrcn1T3K1YldMnFwP7V6B5iVcGjz3cMpAONxT8sG9LWZSerP/usGwBi01OKhPDcQmIQACXx5IEX+zb8Reo+N3eufQ6lsnfxHkVcMpAxreU6UU4uRNRmdTTCNiVAfbk7f9btUFClkCOGdhuNzYgdXSc5/f6fMP902nvFc3ipFA6ubnpR4/3DrzBf/eVEZvwD14b2jXriIFYjNYe3rgcisFzk3f2WjGcpLiug1v+DB8xBJCKsyq8p/zEXP19h7qsMt0wdDczoDY/IrLTZ5Vs5k4wGTeFAvGKjGet9FNcsWDbnIKinuWrVIuK5hf7t4r0G26YLB7QiC2i6RTpnm+ghSrdT4XeXJDth/am8A4Ok4x4ngRWgd0oOCWHyxGIWaUJPeBqa7TBYPd0wGx/dOuNsrD5QYbvbScrHRiXyfLjOXKZ/O0dJY/tLQotLocKLjZLnvnuJb96kzDGlV4k5MTIDa/4nI7kaINHpMj79BlhV2vSEsl7ARDE8OiGIFZ0xV6K2kyYnac/B7ovhN1wf4cBLmSAItbJC43fTW+8Ms0bDRcVyupu4Ip7FHJ4d7uhMwNx0uCT73Jy7d0wijvpvjTqYb1cgH7c2gijQanj0xcbhCSTTFD/+3VlcjOx+krv6S4LtcFx0t8cHPFM7H8OXnncey86FzDej0iymsDXXYGjVcRXG7N7vHHzJnnNt8nyYTFWmOiBP6fs6fu+E5zwBC8v8U2jl9de3bKHKpu6kCYh3CXkeyxuMXiciNe4urCgzQ7uMPHo3iJ351zBau17oPMTdYVfruX5e7S4e7zZRVsWTfiDbjhN7Br3OJEsJjqQNpgB+1MSGdYSQJodFFXsSUL9GOu7vKqGjt0CnWMuCM9MlFO0bW9gLKFYcd1eEfRzAHqdlX99mpWGFSkx9AVsBSk2a7hL2cgCHj7oMET8And73dMRH+qkfFUNGaEU65w0xFNnGjFxW9WYw1K/RVKPB8m28uLsoh2UHo3LInCt7q/mW+E/OctFRhlH/LIMC2LSx23qo7RPGomOCMb1XVVMw3/SmCg7jxhCodYWYx9ra61bDRid9k097iv7j5ejaMoGpFWXZTlb1+NNYkOR5QqCQ4iNxEFNkk5TjXFWvPDVnVVj+fz+dPC7rOH+lA3Fzf0/zpYvPfAQaWvqmoczecLknqo2iAW/r7wiLquT7tBNJhOB09zo0pRny4shMHfXx2mUNX1bjqNnuZPM/Szp7o+/JVQi93Y8Bd1WY4d/RfGjq1O9Wl/VY0jE6toDM7/2f1dVOP/4Ynah/9/D//p4T89/KeH//Twnx7+08N/evhPD//p4T89/KeH//Twnx7+08N/evhPD//p4T/1EOnhP0VmqhjQdGqkwwH+ggkNmX9EgV4/CjrVDC6o+Xq6oAygsu770i8zbQp6AmQ38lNgendCxwK9fhT0NB+c61N9OLhTLpJ38y1y8dUnAJ3z3rExmpIKAtQKVO2ijuZP8+k02ldVdRL6w2PoqzSXoG9Ms7Ghy4l/UcVrG0XRsSgP7IjE/F1A2sCy7G83sEt1oqaGkcTnvDyJa8Ev0z+m1/3BcauqmZ0uq+wgTKsBb/Sun7rpWHZmbv2Lr5pdYsjzGWc76hXXdvkITcspesf0vj05ta4UvsrZLj0J2saph/y2U1JZ0/jMiQshnN4U2At8PvTJqaW2XtnDZC+JDNk3b+5WL69RWhK9FQ731vpKL9Y5pfBzq5ZYbPaQd3ZXha+4spEPEwnv4DQZ93cR2SwkwXPlrFU97+gjOgl49asbBlX4jqBGSbQCqp92hoy5FhwYOA9mHZ/6+wQJqUZyuW/dTDfBSf7UULrnbjCdzufzmd0ihFBEth7yQXxRhW+eRqmu62MUxyOXC4f0XBiRrX9cjb87+KsG8VSV5TJd4IuMtlc8MYVdRMxFq2kRYpmfs1dsWaW8p6PoW28WJwfGlYjryilAmZ3zGWRzj+lgaZzclT7yprUx5L0jV+nbd+Tb/NgQlQQ6dk3DE1P0kQ9M32p8abfVCHHMJieu01GYM2IXPd8D09T7vZSOsLiV/VC8nQHXe5XJ+PTmTwJQH/nA1HDTxsoGLfNR4zWwfNvVPMls4ja2OjAxRQ+5Gn9YkbfeWPKU5XQUZqycX4Pday+5MYsC2vhag3Wm9rIdmVWOcSmiHRTIZs+7Gv9Sg6j2kpRII4CKwaBcjswTU/SS33ZVha/ueXffXSQf0efnmrHH/xsMBmXch94sT4RH1r3e5G0GoLGyp0ayo9RDrsZ/KwgnJNTexnY1JQelZR4h2zebZkS2XvImbat51/EdaLhv/7589LpzHxmRzRyIWxZkR/YA7o5ZBjKnRq7fkTHladvPRWQz18eNjCExsip87emwb2oCzY5Q3tNRlHdQOONJv7i5EwbnhbEa30m7fdXvckN1F2YZyPrI++sXuN25Z7x57xE0BuJcVOHvRnOF3342WoFRxb0I8X7TODHF/tALpuXEKAtIJIsRzUzVaGSrFWgui2c1HYWZWiz94awn3JjlpnFyJpIqfFOC5b+qZqS2WoHmhlVrdE7f/1wMka0fvPk2MlhD1YlAshhLEpWOuz6PjElFNWMqW03eftvEFIrjc5aJIRtzlRPsbZxt4eZyK/x2xPdfE4w1U2vy63lmRsHpCW8aHYLU7zeiQ20yvnHk227uvkT/uBi/1R7avRur8YnpEkFTerMxEc0N320j9YYnpjBJA9qdI7Nlpfc/c17RiREOjdE7bfB17177bZt6C6HhwmAOPVe0224jdbm9TlCwRuEBduRKd+5Vq2L8fvKBSavw3f5erILfVOBxkLHJfjoKgPrBE1OYzaOXiQGSrRF4VkBsxtmZNM+9fTJ3c2nNysN/zc81bvaGG6O1aWxsTKsYkSve2FHAtsXEFP3gZjkyCgO6KnxP3EFu01EYU3She9wTbowuwSI1JkaSVeH/4xHidGSTcf77ouYQ7NxPnpnCW1X4dqlFBy5kvjMQARNT9IWr8Q2JkW+FF8kMRsNzOoqLXQlt9qQPTFWFHz7b+7Yv15ubmELzjMyzqRr/pfTi3qaKSi5khKpDqT88MYXR2jS+TVKF75Gbx2k6CjOBWs54AiCy9YMh2Z5N1fjnmqIK3/sE3RgjbW++Hs2He8qNb6rwkasorQy/ZzwxBSwO3kzV+LsDx/fN+SkGWw1z94rylJ54vBACN4czYLMvfBBjZiTHKnyzsNPF5Kp5EJCjizfmzb4wGfFoipPnahAXHP25rzZtP3ZiCg6W4NZcjW9ML9GW6B27FY/WZJ3/sgA+OM/MpYh95Z0tq/A9UDBh7ua5t82mEZFt17OdmMLCIjqaqvGXhd2R9Segm4E1OzMXIVqS+e3ecGN0CRrkijJV+DwMRdOF5PFLLKpUAEN399oT3gRCcOOZIUdlWLXamsJbjtkyE/MnGSKx3ViTdjsb7vHx0Fc+cJukinSpwmdRMgjsyXA6isKWesObZmGxnBir8S2A2DxEDJDYzJ+eNCFOq819z/fDdpkhxoO0uBaNVfhaU5spvTBPn8RElhuqWOyNSePEFMO6L7y5uvEhtsjb8qRVFT4HQ9HsKmWQ0+rii/d5GzunYBUb7KdVfleF7z8qGfwSB4S80Vc+sDeq8M3hU47bbshQ9vncoOH0hKvxd+/Gavybvb1z5EvBhNGYFvrqTe8MVeH7oAWQQ1lQf3sTqEYYLgypkePKL1X4t77kGbA3h+ko3BAwMUVvuUGq8NXva+Qsz20mm/3hanzDbAn7g/rvU9TcrwdiCZmYojcMyWbMSk1M7S9tNQvE0wq8/4PJdBQs3u4Pb76NDJBsY2OszgsvY1Ulj5bNZl+4Gr80GZs/TIbaT/1fQA0iB2i5xB0BE1P0kjfNoC3CHYQMvKQlKDY5TEdhFuZkgcQFstlPrsZXfW+zYMMu2mfze3ghsd1i91h8YSOozwTY7EE3W9V77+OMJliBJqGIxTtGtDrKihdgYoq+MNXnVregEYtb8bXs/lqaMmq/NT+JwXQUgIealHrQjTmw9lvt48QtuoQpn6jxM7PYBrDdCP3c51lv+A3AeHqZwK3SPdGlSgJ9XUDUWGwjSUqUDTIxRf94ciZjFb66LtfpfNqgj9pOJsijCJGyUtMspGNgsz/cLO8KC6yq8FkE7nKaYGhK9RMQ3NEWgBh83UkBPVrFAeC1Em7uX4HN3nA1fnEn76yq8FnMwnCTu2IvH2v3P4HZu4iAXyCVmrRN/3ZiCsrsSI9U4ePJRJej8d12vdkzrsb3yGwUyDwUFzua6/ZvYiN/9wpMTNEj3lnVKnwXuyWMknwm5jRdB0a++e3+cHNcAFX4Pum9zsPEZhtwUTvIdTLmxTa3t0fc+KEKHwRguym+4LNtvjvXL079thGR7XzoDVP1PDG23ljL/rT8ChZIbGChCvXOwGafuDFW4atMSAw1d7qGTekE5en2uDcBK+rNIBK0rg4wKQ/F/cXj9A6epeQUkW3cTEzRI8blNlTh60vmwGBVcAigAhMQWpVqOp2Yok9M7VX4yr9XVy1I19K2aeDmxpN+7RvEVeLbd+Wq8Img3E714dA2z4OQbRc7Gzdfeq7L0pTzb0StNuaCtJUUnCz9hxtjdTpuZX0QkfHKwNePpJSSppyB+HoCWKTLs/GKU1KrUrMbGL9937W4gra5SQWhEXF0v4PT9XM9fx/d9XR+ISXejof/fw//6eE/Pfynh//08J8e/tPDf3r4Tw//6eE/Pfynh//08J8e/tPDfwooevhPAwBWUDggmAoAANAMAZ0BKgIHmgE+USKPRSOiIRSvvAA4BQS0t3C4j4B/WP4J+An6AfwD7ckBeAP0A/gH3ec88B/APwA/QD+AeoP7T/APwA/QD+Afv/R0/QD+AfgB+gH8A8P9Ir//7P/mgPwD+AfgB+gH8AwNJW/0A/gH4AfoB/AP397/BTGQgJYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQgJYIdlQyAP5PpOkn0gyWPDtAQFcshMF3BhqtI31zlUH0XPjWiOypia7GSq4lh2gHzlqgcTXY0Bdn9ec9Q9t4GS2PJPpCGCSFi5CO37hXbzC4nSAPPCRoC7QEBccM1ibguJuo1oH13DtAQF2gIDV7KWB8Tx6mR7zVcrO+tQxCsiPUsbmmV3ncT4IM2n1eKiCmWf4rkAtu5UJFVZMTakrZqYdUbVASrm/RVyv/xHZSrdZDsprJm1qAhcuyDnWRn64FUfo7KWB83k5vMZ6VPjPcdcURwg1c5aX22zFYuqFlIDkgtYVqJ7Zl7Rpvdr/Fb+e78SBRVAEHPSAmWk11zDsotRkSOGzUw6o2na2Wzg5mHVNqR7lgWUsD48TKhiO5oPb2oX/xCkkYBDsqGQgJX+K4uGq4ruQq6N+sf4I0tZMLJ/LfeFz9AKrvNuVjtP7y7EvHQ6eW8c03JWgNZNvUt6QsXJqN13X0CD001xQgXTQsXJHn7ebRPoQDUR0Q67Vs18NxrdSzYwSQrILBJDoAE7T+8ioLvTUfxK+2iGUoK7l4bUj3S+szQFx9Xj9tSCXbIN8AQfiSGDqSMpHT4Ki6mRUIscSZF1EepkdR1UI91ulyfEdUq3xAUyLpwYIdlQxIhDp8FMioLu+67wuC3smw0AjfejNJpYZaV6VSnP/0zSlNXfFxU/SKfOmxZCoz1XwsxDnXph2Uqet5d52pfKQsUH1NAvR9S3iKEC6aFi4j5zcdHoWS1RDQEtiMR0eplQyDwp6rwVEiKI9NXFJuJRtF1RDvu7ktQX5oqZI1cXbt6CilPN6R6NN7E3GGm6vq+6uzcbjW6lj2+ahuzFmsgukmYaQ1CPUymsn1W6NeOiM8/wXTUfxMqEdUn1zDspYIariu5UMSIQ6d8KiJNVzuOBiP+rUdUyje2ymoC4Wx13X2rZ5+vpj+kXd/QIPTTIMmMD9FwIU64R2O5Clvq1U0RLY4EYJJYNoYkhZykujeGZ2PITh2b3rGEuJwDOejSvzmgmRHqZUMg8Keq8FRIiiPTVxXBxZoG2Vcnib4ZrExzzyklxOqKkQhtKdwguBCnapqDVnlush1l4rger0x2ehqu2QogxIhAHQckRRHfeJkdU1l2GaFQgdxa9R2P3+IzQNCylf4ri4ariu1eLx32Cu+KPIpTohZbG1GtBZrw6fhtKf/NxivFVb1s+8/OfWUZm1Y/doBdNXbIUQYkQhr7baduVS7yjxt31jqoYkSTQso0lA4hY5+72TXqMi1iqt8LxAVFvuu8SyDg+bs0aLOJ0aMRxGLMPEyPkoS/C8QFLwD8DIR5eaNmcX/rY9QNF1nnbIUQYkSTjSfSc0rNHygblukivtdH86t8eJkdU2FlseQisAfGvE40z+XQ2z0LrlkHB9qYZoGhZBO0/u8A/KHH+rtfEdlFqMiSfVyjS1NtALf0HnE6csfRcOqi0Z+Z/Iu9SyFEGQeDagNeJ8oFal4+1E+I7KVboWR+UNiOgewQddw8xgjM20AupZfBLot/eVRglXQ9/PIlLA+byRfnw6LqWXwS5lnqvhZwx0YckqWL5DUwzjSfSdJPpU+fyTlv7yc/npVGCVdD5J9J0k+RIPK5JCvephnGknLqZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICV/THHDbBA4/9kmGrzCnndUoOIQu8uCBjjiOylgh2VDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlgfHVu+KPAdedKA/MgB6SzK+8Qu5G6rmNGC6t3xR5JSwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ6yDkhAuoP0OfWOIX7sybpMIzC0QILelrHafsuMCpJspYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQgJYHw/m7MSfwDixfDf+mFsWYo3vTxM77NtQCpwvvjkmsCo+SHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUMhASwQ7KhkICWCHZUI6lJZbMXtAODYxJqjagM0e7xJ1fW4Qy/jxMqGQgJYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQgJYIdlQyEBLBDsqGQAXt8Aj3LtHp6Qdukboc/fwX1VJyqQ/oYRCtTuDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlgh2VDH6SWWOLLq5Y8nVwGmpu5Ufk6R8aWKdq2XkqyxJSN/hhMxXRwSIWUsEOyoZCAlgh2VDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlgh2VDIQEsEOyoZCAlTAAP3iOAAAAAAAABnVNnTzNv9E5tS36HqP0PGfonN536JzbtfRObbb9E5uHpRs9VT9E5uF/onNtJ+ic3Bf0Tm0qiTpzsNBHPp9E9hJmgHtjsphLT9FB/omwROKj7KeJKnfVu2icxTfoktgCNzLZQU/0Us7+jSMlY/ooP9E3ZNHugQRAhcUvOAQxbP8S2PZ/kaeJj6JzKV+jT4tShRH0tcgShVGBKlf//yb0eRb9FKACsRat0gv/0Tx0BkBmvCXO+dnVD3ArIz9E9hLWS6aQO/U0IPSBcTtU1EP6KVOJU9No/0aeFUr+iNn0UrTx4JoYEqW79EqnKfoqkY1Or75cQkYoXduQ/mutDdkVO6CXf9wHF9Gmd3VcmS65huZ9R/o0+LVqSz53IIWatSAJf9EbPo0+yQQw7P0AOnU0ILyao1ogvc9Zt03P1bH0OAArTWlw/RPHQGQGa3SL/RGz6NHc7XOy87fKYcNb+ilAErWyDkgHHizTU+wTxXZ+jTwp0ARn6NM7uq5MlIAMqKrwAAAAAAAAAAAAAACgSp6bsPvNaUsacWcdlN4tWmf03IAAA7it29l8dELu3IvTwIIbORHUeAAAQzKP0fmLvCmsQc6FEAACe/RWp+jSNMzt8pnQWl3iTLAAAMCg3eJOv3pZR+j8x+v0Ya1XhZ4AADW7xJmBGAI3LukksZfsXqqd6AAAY75H8jWcXAt4a6DnqTZBKg1/RSgAAAAAAAAAAAAAA==" alt="TransPerfect Media" class="footer-logo" />
            </a>
        </footer>
    </div>

    <script>
        // State
        let parsedData = null;
        let currentFileName = '';
        let currentFilter = null;

        // DOM Elements
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileMeta = document.getElementById('fileMeta');
        const fileRemove = document.getElementById('fileRemove');
        const previewSection = document.getElementById('previewSection');
        const previewBody = document.getElementById('previewBody');
        const lineCount = document.getElementById('lineCount');
        const charCount = document.getElementById('charCount');
        const convertBtn = document.getElementById('convertBtn');
        const particles = document.getElementById('particles');

        // File size formatter
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Parse DETX file
        function parseDETX(xmlContent) {
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlContent, 'text/xml');
            
            const result = {
                roles: {},
                roleColors: {},
                lines: [],
                metadata: {
                    title: '',
                    episode: '',
                    author: '',
                    summary: ''
                }
            };

            // Parse roles
            const roles = xmlDoc.querySelectorAll('role');
            roles.forEach(role => {
                const id = role.getAttribute('id');
                const name = role.getAttribute('name');
                const color = role.getAttribute('color') || '#6366f1';
                result.roles[id] = name;
                result.roleColors[name] = color;
            });

            // Parse lines
            const lines = xmlDoc.querySelectorAll('line');
            lines.forEach(line => {
                const lipsyncs = line.querySelectorAll('lipsync');
                const textEl = line.querySelector('text');
                
                let tcIn = '';
                let tcOut = '';
                
                lipsyncs.forEach(lipsync => {
                    const type = lipsync.getAttribute('type');
                    if (type && type.includes('in')) {
                        tcIn = lipsync.getAttribute('timecode');
                    } else if (type && type.includes('out')) {
                        tcOut = lipsync.getAttribute('timecode');
                    }
                });

                result.lines.push({
                    tcIn: tcIn,
                    type: 'line',
                    character: line.getAttribute('roleName'),
                    original: textEl ? textEl.textContent : '',
                    translated: '',
                    track: line.getAttribute('track'),
                    tcOut: tcOut
                });
            });

            return result;
        }

        // Generate preview
        function generatePreview(data, filterCharacter = null) {
            previewBody.innerHTML = '';
            
            let linesToShow = data.lines;
            
            // Apply filter if set
            if (filterCharacter) {
                linesToShow = data.lines.filter(line => line.character === filterCharacter);
            }
            
            const previewLines = linesToShow.slice(0, 100); // Show first 100 lines
            previewLines.forEach(line => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="col-tc">${line.tcIn}</td>
                    <td class="col-char">${line.character}</td>
                    <td class="col-text">${line.original}</td>
                    <td class="col-track">${line.track}</td>
                    <td class="col-tc">${line.tcOut}</td>
                `;
                previewBody.appendChild(tr);
            });

            // Update stats
            lineCount.textContent = filterCharacter 
                ? `${linesToShow.length} / ${data.lines.length}` 
                : data.lines.length;
            const uniqueChars = new Set(data.lines.map(l => l.character));
            charCount.textContent = uniqueChars.size;
        }

        // Generate roles list
        function generateRolesList(data) {
            const rolesList = document.getElementById('rolesList');
            const rolesCount = document.getElementById('rolesCount');
            const rolesSection = document.getElementById('rolesSection');
            
            rolesList.innerHTML = '';
            
            const roleNames = Object.values(data.roles);
            rolesCount.textContent = `${roleNames.length} character${roleNames.length !== 1 ? 's' : ''}`;
            
            roleNames.forEach(name => {
                const color = data.roleColors[name] || '#6366f1';
                const tag = document.createElement('div');
                tag.className = 'role-tag';
                tag.dataset.character = name;
                tag.innerHTML = `
                    <span class="role-color" style="background-color: ${color}"></span>
                    <span>${name}</span>
                `;
                tag.addEventListener('click', () => filterByCharacter(name));
                rolesList.appendChild(tag);
            });
            
            rolesSection.classList.add('visible');
        }

        // Show program info
        function showProgramInfo(filename) {
            const { programName, episode, title } = parseFilename(filename);
            const programSection = document.getElementById('programSection');
            
            document.getElementById('programName').textContent = programName || '—';
            document.getElementById('programEpisode').textContent = episode || '—';
            document.getElementById('programTitle').textContent = title || '—';
            
            programSection.classList.add('visible');
        }

        // Filter by character
        function filterByCharacter(characterName) {
            const rolesList = document.getElementById('rolesList');
            const filterIndicator = document.getElementById('filterIndicator');
            const filterValue = document.getElementById('filterValue');
            
            // Toggle filter if clicking same character
            if (currentFilter === characterName) {
                clearFilter();
                return;
            }
            
            currentFilter = characterName;
            
            // Update active state on role tags
            rolesList.querySelectorAll('.role-tag').forEach(tag => {
                if (tag.dataset.character === characterName) {
                    tag.classList.add('active');
                } else {
                    tag.classList.remove('active');
                }
            });
            
            // Show filter indicator
            filterValue.textContent = characterName;
            filterIndicator.classList.add('visible');
            
            // Update preview
            generatePreview(parsedData, characterName);
        }

        // Clear filter
        function clearFilter() {
            const rolesList = document.getElementById('rolesList');
            const filterIndicator = document.getElementById('filterIndicator');
            
            currentFilter = null;
            
            // Remove active state from all role tags
            rolesList.querySelectorAll('.role-tag').forEach(tag => {
                tag.classList.remove('active');
            });
            
            // Hide filter indicator
            filterIndicator.classList.remove('visible');
            
            // Update preview
            if (parsedData) {
                generatePreview(parsedData);
            }
        }

        // Parse filename to extract program, title and episode
        function parseFilename(filename) {
            // Remove extension
            const baseName = filename.replace(/\.detx$/i, '');
            
            let programName = '';
            let title = '';
            let episode = '';
            
            // Split filename into parts
            const parts = baseName.split(/[_\-\s]+/);
            
            // First part is usually the program name (e.g., SNH)
            if (parts.length > 0 && /^[A-Z]{2,10}$/i.test(parts[0])) {
                programName = parts[0].toUpperCase();
            }
            
            // Try to extract episode number (e.g., Ep102, EP_102, Episode102, etc.)
            const episodeMatch = baseName.match(/[Ee][Pp]_?(\d+)/);
            if (episodeMatch) {
                episode = episodeMatch[1];
            }
            
            // Find significant title words (not dates, not episode markers)
            const titleCandidates = parts.filter(part => {
                // Skip date patterns
                if (/^\d{6,8}$/.test(part)) return false;
                // Skip episode markers
                if (/^[Ee][Pp]\d+$/.test(part)) return false;
                // Skip program name prefix
                if (programName && part.toUpperCase() === programName) return false;
                // Skip common prefixes
                if (/^(Transcript)$/i.test(part)) return false;
                return true;
            });
            
            // Look for FINAL, DRAFT, etc. as title
            const statusWords = titleCandidates.filter(p => /^(FINAL|DRAFT|V\d+|REV\d*)$/i.test(p));
            if (statusWords.length > 0) {
                title = statusWords[0].toUpperCase();
            } else if (titleCandidates.length > 0) {
                title = titleCandidates[0];
            }
            
            return { programName, title, episode };
        }

        // Convert to XLSX
        function convertToXLSX(data, filename) {
            // Parse filename for title and episode
            const { programName, title, episode } = parseFilename(filename);
            
            // Define styles
            const styles = {
                header: {
                    font: { bold: true, color: { rgb: "FFFFFF" } },
                    fill: { fgColor: { rgb: "4F46E5" } }, // Primary purple
                    alignment: { horizontal: "center", vertical: "center" }
                },
                headerLight: {
                    font: { bold: true, color: { rgb: "1E1B4B" } },
                    fill: { fgColor: { rgb: "E0E7FF" } }, // Light indigo
                    alignment: { horizontal: "center", vertical: "center" }
                },
                translateCell: {
                    fill: { fgColor: { rgb: "EDE9FE" } } // Light purple for translation areas
                },
                metaRow: {
                    fill: { fgColor: { rgb: "F5F3FF" } } // Very light purple for metadata
                },
                roleRow: {
                    fill: { fgColor: { rgb: "F0FDFA" } } // Light teal for roles
                },
                lineRowEven: {
                    fill: { fgColor: { rgb: "FAFAFA" } } // Light gray
                },
                lineRowOdd: {
                    fill: { fgColor: { rgb: "FFFFFF" } } // White
                },
                tcCell: {
                    font: { color: { rgb: "6B7280" } },
                    alignment: { horizontal: "center" }
                },
                characterCell: {
                    font: { color: { rgb: "6366F1" }, bold: true }
                }
            };
            
            // Prepare rows - Programme block first, then Roles, then Lines
            const rows = [
                // Programme block
                ['', 'programme', '', programName || '', '', '', ''],
                ['', 'episode', '', episode || '', '', '', ''],
                ['', 'title', '', title || '', '', '', ''],
                ['', 'author', '', '', '', '', ''],
                ['', 'summary', '', '', '', '', ''],
                ['', 'notes', '', '', '', '', '']
            ];

            // Add role rows
            Object.entries(data.roles).forEach(([id, name]) => {
                rows.push(['', 'role', id, name, '', '', '']);
            });

            // Add header row just before lines
            const headerRowIndex = rows.length;
            rows.push(['TCin', 'Type', 'Character', 'Original', 'Translated', 'Track', 'TCout']);

            // Track where lines start (after header row)
            const linesStartRow = rows.length;

            // Add line rows
            data.lines.forEach(line => {
                rows.push([
                    line.tcIn,
                    'line',
                    line.character,
                    line.original,
                    line.translated,
                    line.track,
                    line.tcOut
                ]);
            });

            // Calculate max widths for columns
            let colWidths = [12, 8, 10, 20, 60, 6, 12]; // defaults - E column (Translated) starts wider
            
            // Track max character name length separately
            let maxCharNameLen = 10;
            
            rows.forEach((row, rowIdx) => {
                row.forEach((cell, idx) => {
                    const len = cell ? String(cell).length : 0;
                    
                    // For role rows, character name is in D column (idx 3), use it for C column width
                    if (row[1] === 'role' && idx === 3) {
                        if (len > maxCharNameLen) {
                            maxCharNameLen = len;
                        }
                    }
                    // For line rows, character name is in C column (idx 2)
                    else if (row[1] === 'line' && idx === 2) {
                        if (len > maxCharNameLen) {
                            maxCharNameLen = len;
                        }
                    }
                    // For D column (Original), track separately
                    else if (idx === 3 && row[1] === 'line') {
                        if (len > colWidths[idx]) {
                            colWidths[idx] = len;
                        }
                    }
                });
            });
            
            // Set C column width from character names
            colWidths[2] = maxCharNameLen;
            
            // Add padding and cap widths
            colWidths = colWidths.map((w, i) => {
                if (i === 4) return Math.max(w + 6, 70); // Translated - minimum 70, for French adaptation
                if (i === 3) return Math.min(w + 6, 100); // Original
                if (i === 2) return Math.min(w + 4, 40); // Character
                return Math.min(w + 2, 20);
            });

            // Create worksheet
            const ws = XLSX.utils.aoa_to_sheet(rows);

            // Apply styles to cells
            const range = XLSX.utils.decode_range(ws['!ref']);
            
            for (let R = range.s.r; R <= range.e.r; R++) {
                for (let C = range.s.c; C <= range.e.c; C++) {
                    const cellRef = XLSX.utils.encode_cell({ r: R, c: C });
                    if (!ws[cellRef]) ws[cellRef] = { v: '', t: 's' };
                    
                    // Rows 0-5: Programme/Metadata block (programme, episode, title, author, summary, notes)
                    if (R >= 0 && R <= 5) {
                        ws[cellRef].s = { ...styles.metaRow };
                        // Translation cells for title (row 2), summary (row 4), notes (row 5) - column E
                        if (C === 4 && (R === 2 || R === 4 || R === 5)) {
                            ws[cellRef].s = styles.translateCell;
                        }
                    }
                    // Role rows (from row 6 to before header row)
                    else if (R >= 6 && R < headerRowIndex) {
                        ws[cellRef].s = styles.roleRow;
                    }
                    // Header row (just before lines)
                    else if (R === headerRowIndex) {
                        ws[cellRef].s = styles.header;
                    }
                    // Line rows
                    else if (R >= linesStartRow) {
                        const isEven = (R - linesStartRow) % 2 === 0;
                        ws[cellRef].s = isEven ? { ...styles.lineRowEven } : { ...styles.lineRowOdd };
                        
                        // Timecode columns (A and G)
                        if (C === 0 || C === 6) {
                            ws[cellRef].s = { ...ws[cellRef].s, ...styles.tcCell };
                        }
                        // Character column (C)
                        if (C === 2) {
                            ws[cellRef].s = { ...ws[cellRef].s, ...styles.characterCell };
                        }
                        // Translated column (E) - highlight for translation
                        if (C === 4) {
                            ws[cellRef].s = styles.translateCell;
                        }
                    }
                }
            }

            // Set column widths
            // Note: Excel uses character width units, ~7.5 pixels per character. 300px ≈ 40 chars
            colWidths[2] = 40; // Force C column to ~300 pixels
            ws['!cols'] = colWidths.map(w => ({ wch: w }));

            // Create Help sheet
            const helpRows = [
                ['TCin', 'Type', 'Character', 'Original', 'Translated', 'Track', 'TCout'],
                ['Time code in', 'Type of row', 'Identifier of a character', 'Original content', 'Translated content', 'Numeric identifiers for line and loop', 'Time code out'],
                ['Relevant for start, loop, shot, and line', 'For headers, will be: programme, episode, title, summary, author, notes or role.', 'Defined in header "role" and used as reference in lines', 'Also contains misc info: author name, episode code, ...', 'You only need to translate highlighted cells: title, summary, notes and line', '', ''],
                ['', 'For content, will be: start, loop, line or shot.', '', '', '', '', ''],
                ['', 'You only need to translate the lines and these 3 headers: title, summary and notes.', '', '', '', '', '']
            ];

            const wsHelp = XLSX.utils.aoa_to_sheet(helpRows);

            // Calculate help sheet column widths
            let helpColWidths = [12, 12, 12, 12, 12, 12, 12];
            helpRows.forEach(row => {
                row.forEach((cell, idx) => {
                    const len = cell ? String(cell).length : 0;
                    if (len > helpColWidths[idx]) {
                        helpColWidths[idx] = len;
                    }
                });
            });
            helpColWidths = helpColWidths.map(w => Math.min(w + 4, 60));

            // Style Help sheet
            const helpRange = XLSX.utils.decode_range(wsHelp['!ref']);
            for (let R = helpRange.s.r; R <= helpRange.e.r; R++) {
                for (let C = helpRange.s.c; C <= helpRange.e.c; C++) {
                    const cellRef = XLSX.utils.encode_cell({ r: R, c: C });
                    if (!wsHelp[cellRef]) wsHelp[cellRef] = { v: '', t: 's' };
                    
                    if (R === 0) {
                        wsHelp[cellRef].s = styles.header;
                    } else {
                        wsHelp[cellRef].s = styles.metaRow;
                    }
                }
            }

            wsHelp['!cols'] = helpColWidths.map(w => ({ wch: w }));

            // Create workbook with both sheets
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Transcript');
            XLSX.utils.book_append_sheet(wb, wsHelp, 'Help');

            return wb;
        }

        // Create particles for success animation
        function createParticles() {
            particles.innerHTML = '';
            const count = 12;
            for (let i = 0; i < count; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                const angle = (i / count) * Math.PI * 2;
                const distance = 60 + Math.random() * 40;
                particle.style.left = '50%';
                particle.style.top = '50%';
                particle.style.setProperty('--tx', `${Math.cos(angle) * distance}px`);
                particle.style.setProperty('--ty', `${Math.sin(angle) * distance}px`);
                particle.style.animationDelay = `${i * 0.02}s`;
                particles.appendChild(particle);
            }
        }

        // Handle file selection
        function handleFile(file) {
            if (!file.name.endsWith('.detx')) {
                alert('Please select a .detx file');
                return;
            }

            // Clear any existing filter
            currentFilter = null;
            document.getElementById('filterIndicator').classList.remove('visible');

            currentFileName = file.name;
            fileName.textContent = file.name;
            fileMeta.textContent = formatFileSize(file.size);
            
            fileInfo.classList.add('visible');
            dropZone.classList.add('has-file');

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    parsedData = parseDETX(e.target.result);
                    showProgramInfo(file.name);
                    generateRolesList(parsedData);
                    generatePreview(parsedData);
                    previewSection.classList.add('visible');
                    convertBtn.classList.add('visible');
                    
                    // Reset button state
                    convertBtn.classList.remove('processing', 'success');
                } catch (error) {
                    console.error('Error parsing DETX file:', error);
                    alert('Error parsing DETX file. Please ensure it is a valid DETX format.');
                }
            };
            reader.readAsText(file);
        }

        // Reset state
        function resetState() {
            parsedData = null;
            currentFileName = '';
            currentFilter = null;
            fileInput.value = '';
            fileInfo.classList.remove('visible');
            dropZone.classList.remove('has-file');
            document.getElementById('programSection').classList.remove('visible');
            document.getElementById('rolesSection').classList.remove('visible');
            document.getElementById('filterIndicator').classList.remove('visible');
            previewSection.classList.remove('visible');
            convertBtn.classList.remove('visible', 'processing', 'success');
            previewBody.innerHTML = '';
            document.getElementById('rolesList').innerHTML = '';
        }

        // Event listeners
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('drag-over');
        });

        dropZone.addEventListener('dragleave', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        dropZone.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        fileRemove.addEventListener('click', (e) => {
            e.stopPropagation();
            resetState();
        });

        document.getElementById('filterClear').addEventListener('click', clearFilter);

        convertBtn.addEventListener('click', () => {
            if (!parsedData) return;

            // Start processing animation
            convertBtn.classList.add('processing');

            // Simulate slight delay for better UX
            setTimeout(() => {
                try {
                    const workbook = convertToXLSX(parsedData, currentFileName);
                    const outputName = currentFileName.replace('.detx', '.xlsx');
                    
                    // Create particles
                    createParticles();
                    
                    // Show success state
                    convertBtn.classList.remove('processing');
                    convertBtn.classList.add('success');

                    // Download file
                    XLSX.writeFile(workbook, outputName);

                    // Reset button after delay
                    setTimeout(() => {
                        convertBtn.classList.remove('success');
                    }, 2500);

                } catch (error) {
                    console.error('Error converting file:', error);
                    convertBtn.classList.remove('processing');
                    alert('Error converting file. Please try again.');
                }
            }, 800);
        });

        // Prevent default drag behaviors on document
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            document.body.addEventListener(eventName, (e) => {
                e.preventDefault();
                e.stopPropagation();
            }, false);
        });
    </script>
</body>
</html>
